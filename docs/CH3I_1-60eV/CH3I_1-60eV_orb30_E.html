

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ePSproc: CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), 1 - 60 eV &mdash; ePSdata 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ePSproc: DABCO wavefn run, HOMO ionization (orb 31 A1P), 0.05 - 5.01eV high res" href="../DABCO/DABCO_0.01-5.01eV_orb31_A1P.html" />
    <link rel="prev" title="ePSproc: CH3I wavefn test run, orb 29 ioinzation (sigma bonding, A1), 1 - 60 eV" href="CH3I_1-60eV_orb29_A1.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> ePSdata
          

          
            
            <img src="../_static/ePSproc_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Intro:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About ePSdata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methods.html">Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citation</a></li>
</ul>
<p class="caption"><span class="caption-text">ABCO</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ABCO/ABCO_0.01-5.01eV_orb31_A1.html">ePSproc: ABCO wavefn run, HOMO ioinzation (A1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ABCO/ABCO_1-50eV_orb30_E.html">ePSproc: ABCO HOMO-1 (orb 30) ioinzation (E) 1-50eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ABCO/ABCO_1-50eV_orb31_A1.html">ePSproc: ABCO HOMO (orb 31) ioinzation (A1) 1-50eV</a></li>
</ul>
<p class="caption"><span class="caption-text">C2H4_1.0-100.0eV</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../C2H4_1.0-100.0eV/C2H4_1.0-100.0eV_orb1_Ag.html">ePSproc: Ethylene (C2H4), orb 1 ionization (Ag), wavefn run, 1.0:2.5:100.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../C2H4_1.0-100.0eV/C2H4_1.0-100.0eV_orb2_B1u.html">ePSproc: Ethylene (C2H4), orb 2 ionization (B1u), wavefn run, 1.0:2.5:100.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../C2H4_1.0-100.0eV/C2H4_1.0-100.0eV_orb3_Ag.html">ePSproc: Ethylene (C2H4), orb 3 ionization (Ag), wavefn run, 1.0:2.5:100.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../C2H4_1.0-100.0eV/C2H4_1.0-100.0eV_orb4_B1u.html">ePSproc: Ethylene (C2H4), orb 4 ionization (B1u), wavefn run, 1.0:2.5:100.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../C2H4_1.0-100.0eV/C2H4_1.0-100.0eV_orb6_Ag.html">ePSproc: Ethylene (C2H4), orb 6 (HOMO-2) ionization (Ag), wavefn run, 1.0:2.5:100.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../C2H4_1.0-100.0eV/C2H4_1.0-100.0eV_orb7_B3g.html">ePSproc: Ethylene (C2H4), orb 7 (HOMO-1) ionization (B3g), wavefn run, 1.0:2.5:100.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../C2H4_1.0-100.0eV/C2H4_1.0-100.0eV_orb8_B3u.html">ePSproc: Ethylene (C2H4), orb 8 (HOMO) ionization (B3u), wavefn run, 1.0:2.5:100.0</a></li>
</ul>
<p class="caption"><span class="caption-text">CH3I_1-60eV</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="CH3I_1-60eV_orb10_A1.html">ePSproc: CH3I wavefn test run, orb 10 ioinzation (Iodine 3d, A1), 1 - 60 eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="CH3I_1-60eV_orb11_E.html">ePSproc: CH3I wavefn test run, orb 11 ioinzation (Iodine 3d, E), 1 - 60 eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="CH3I_1-60eV_orb13_E.html">ePSproc: CH3I wavefn test run, orb 13 ioinzation (Iodine 3d, E xy), 1 - 60 eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="CH3I_1-60eV_orb20_A1.html">ePSproc: CH3I wavefn run, orb 20 ionization (Iodine 4d, A1), 1 - 60 eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="CH3I_1-60eV_orb21_E.html">ePSproc: CH3I wavefn test run, orb 21 ioinzation (Iodine 4d, E), 1 - 60 eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="CH3I_1-60eV_orb23_E.html">ePSproc: CH3I wavefn test run, orb 23 ioinzation (Iodine 4d, E), 1 - 60 eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="CH3I_1-60eV_orb29_A1.html">ePSproc: CH3I wavefn test run, orb 29 ioinzation (sigma bonding, A1), 1 - 60 eV</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ePSproc: CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), 1 - 60 eV</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Job-details">Job details</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Set-up">Set-up</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Load-modules">Load modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Load-data">Load data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Job-&amp;-molecule-info">Job &amp; molecule info</a></li>
<li class="toctree-l2"><a class="reference internal" href="#1-photon-ePS-Cross-Sections">1-photon ePS Cross-Sections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Cross-sections-by-symmetry-&amp;-type">Cross-sections by symmetry &amp; type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#\beta_{2}-by-symmetry-&amp;-type"><span class="math notranslate nohighlight">\(\beta_{2}\)</span> by symmetry &amp; type</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Dipole-matrix-elements">Dipole matrix elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#MFPADs">MFPADs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Error-&amp;-consistency-checks">Error &amp; consistency checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Version-info">Version info</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Original-job-details">Original job details</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ePSproc-details">ePSproc details</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Cite-this-dataset">Cite this dataset</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">DABCO</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DABCO/DABCO_0.01-5.01eV_orb31_A1P.html">ePSproc: DABCO wavefn run, HOMO ionization (orb 31 A1P), 0.05 - 5.01eV high res</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DABCO/DABCO_0.5-10.5eV_orb31_A1P.html">ePSproc: DABCO, HOMO ioinzation (orb 31 A1P), 0.5 - 10.5eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DABCO/DABCO_1-50.0eV_orb30_A2PP.html">ePSproc: DABCO, HOMO-1 ionization (orb 30, A2PP), 1 - 50eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DABCO/DABCO_1-50.0eV_orb31_A1P.html">ePSproc: DABCO, HOMO ionization (orb 31, A1P), 1 - 50eV</a></li>
</ul>
<p class="caption"><span class="caption-text">XeF2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../XeF2/xef2_1.0-60.1eV_orb12_A1G.html">ePSproc: xef2 wavefn run, orb 12 ioinzation (Iodine 3d, A1G/SG), 1-60eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../XeF2/xef2_1.0-60.1eV_orb13_E1G.html">ePSproc: xef2 wavefn run, orb 13 ioinzation (Iodine 3d, E1G/PG), 1-60eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../XeF2/xef2_1.0-60.1eV_orb15_E2G.html">ePSproc: xef2 wavefn run, orb 15 ioinzation (Iodine 3d, E2G/DG), 1-60eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../XeF2/xef2_1.0-60.1eV_orb21_A1G.html">ePSproc: xef2 wavefn test run, orb 21 ioinzation (Iodine 4d, A1G/SG), 1-60eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../XeF2/xef2_1.0-60.1eV_orb22_E1G.html">ePSproc: xef2 wavefn test run, orb 22 ioinzation (Iodine 4d, E1G/PG), 1-60eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../XeF2/xef2_1.0-60.1eV_orb24_E2G.html">ePSproc: xef2 wavefn test run, orb 24 ioinzation (Iodine 4d, E2G/DG), 1-60eV</a></li>
</ul>
<p class="caption"><span class="caption-text">XeF2-preliminary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../XeF2-preliminary/XeF2_highRes_wf.orb21_A1G.html">XeF2 (4d sigma, orb21 A1G/SG), 1-350eV Preliminary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../XeF2-preliminary/XeF2_highRes_wf.orb22_E1G.html">XeF2 (4d pi, orb22-23 E1G/PG), 1-350eV Preliminary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../XeF2-preliminary/XeF2_highRes_wf.orb24_E2G.html">XeF2 (4d delta, orb24-25, E2G/DG), 1-350eV Preliminary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../XeF2-preliminary/XeF2_multi-orb_comparisons_270320-dist.html">XeF2 1 - 300eV Multi-orb processing</a></li>
</ul>
<p class="caption"><span class="caption-text">aniline</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../aniline/aniline_wf_0.1-10.1eV_orb23_B1.html">ePSproc: Aniline Orb 23 (B1) ionization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aniline/aniline_wf_0.1-10.1eV_orb24_A2.html">ePSproc: Aniline Orb 24 (A2) ionization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aniline/aniline_wf_0.1-10.1eV_orb33_A2.html">ePSproc: Aniline Orb 33 (A2) ionization</a></li>
</ul>
<p class="caption"><span class="caption-text">naphthalene</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene/naphthalene_wf_1.0-10.1eV_orb34.html">ePSproc: Naphthalene HOMO Orb 34 (Au) ionization, 1-10eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene/naphthalene_wf_1.0-30.1eV_orb33-45_S1.html">ePSproc: Naphthalene S1 component Orb 33 &gt; 45 (B3u) ionization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene/naphthalene_wf_1.0-30.1eV_orb34.html">ePSproc: Naphthalene HOMO Orb 34 (Au) ionization, 1.0 - 30.1 eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene/naphthalene_wf_1.0-30.1eV_orb34-42_S1.html">ePSproc: Naphthalene S1 component Orb 34 &gt; 42 (B3u) ionization, 1.0 - 30.1 eV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene/naphthalene_wf_1.0-30.1eV_orb34-45_S2.html">ePSproc: Naphthalene S2 component Orb 34 &gt; 45 (B2u) ionization, 1.0 - 30.1 eV</a></li>
</ul>
<p class="caption"><span class="caption-text">naphthalene-preliminary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene-preliminary/naphthalene_wf_1.0-30.1eV_orb33-45_S1.html">ePSproc: auto-gen template development, Jupyter-runner version TIDY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene-preliminary/naphthalene_wf_1.0-30.1eV_orb34.html">ePSproc: auto-gen template development, Jupyter-runner version TIDY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene-preliminary/naphthalene_wf_1.0-30.1eV_orb34-42_S1.html">ePSproc: auto-gen template development, Jupyter-runner version TIDY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../naphthalene-preliminary/naphthalene_wf_1.0-30.1eV_orb34-45_S2.html">ePSproc: auto-gen template development, Jupyter-runner version TIDY</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ePSdata</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>ePSproc: CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), 1 - 60 eV</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/CH3I_1-60eV/CH3I_1-60eV_orb30_E.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">This page was auto-generated from a Jupyter notebook: <a class="reference external" href="https://github.com/phockett/ePSdata/blob/master/source/CH3I_1-60eV/CH3I_1-60eV_orb30_E.ipynb">CH3I_1-60eV/CH3I_1-60eV_orb30_E</a>.</p>
<blockquote>
<div><ul class="simple">
<li><ul>
<li><p><a class="reference external" href="https://phockett.github.io/ePSdata/about.html">About ePSdata</a></p></li>
</ul>
</li>
<li><ul>
<li><p><a class="reference external" href="#Cite-this-dataset">Cite this dataset</a>.</p></li>
</ul>
</li>
<li><ul>
<li><p>Problems?  Please raise <a class="reference external" href="https://github.com/phockett/ePSdata/issues/new/choose">any issues on Github</a>.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
<p><a class="reference external" href="http://dx.doi.org/10.5281/zenodo.3660716"><img alt="DOI" src="https://zenodo.org/badge/doi/10.5281/zenodo.3660716.svg" /></a> <a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 (CC BY-NC-SA 4.0)" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
<div class="section" id="ePSproc:-CH3I-wavefn-test-run,-orb-30-ioinzation-(pi-anti-bonding),-1---60-eV">
<h1>ePSproc: CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), 1 - 60 eV<a class="headerlink" href="#ePSproc:-CH3I-wavefn-test-run,-orb-30-ioinzation-(pi-anti-bonding),-1---60-eV" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><em>electronic structure input</em>: CH3I_ref_opt_SPK-AQZP_C3v.molden</p></li>
<li><p><em>ePS output file</em>: CH3I_1-60eV_orb30_E.inp.out</p></li>
<li><p><em>Web version</em>: <a class="reference external" href="https://phockett.github.io/ePSdata/CH3I_1-60eV/CH3I_1-60eV_orb30_E.html">https://phockett.github.io/ePSdata/CH3I_1-60eV/CH3I_1-60eV_orb30_E.html</a></p></li>
<li><p>Dataset: <a class="reference external" href="https://zenodo.org/record/3660716">https://zenodo.org/record/3660716</a></p></li>
<li><p>DOI (dataset): <a class="reference external" href="http://dx.doi.org/10.5281/zenodo.3660716">10.5281/zenodo.3660716</a></p></li>
<li><p>Licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 (CC BY-NC-SA 4.0)</a></p></li>
<li><p><a class="reference external" href="#Cite-this-dataset">Citation details</a></p></li>
</ul>
<div class="section" id="Job-details">
<h2>Job details<a class="headerlink" href="#Job-details" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>ePS CH3I, batch CH3I_1-60eV, orbital orb30_E</p></li>
<li><p>CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), sph/ grid</p></li>
<li><p>E=1:2.5:60 (24 points)</p></li>
<li><p>Mon Mar 5 07:27:04 EST 2018</p></li>
</ul>
</div>
<div class="section" id="Set-up">
<h2>Set-up<a class="headerlink" href="#Set-up" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Load-modules">
<h3>Load modules<a class="headerlink" href="#Load-modules" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">epsproc</span> <span class="k">as</span> <span class="nn">ep</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>
<span class="n">timeString</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* pyevtk not found, VTK export not available.
* plotly not found, plotly plots not available.
</pre></div></div>
</div>
</div>
<div class="section" id="Load-data">
<h3>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># File path only, from env var DATAFILE</span>
<span class="c1"># dataPath = os.getcwd()</span>
<span class="n">dataFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DATAFILE&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jobInfo</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">headerFileParse</span><span class="p">(</span><span class="n">dataFile</span><span class="p">)</span>
<span class="n">molInfo</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">molInfoParse</span><span class="p">(</span><span class="n">dataFile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
*** Job info from file header.

 ePS CH3I, batch CH3I_1-60eV, orbital orb30_E
 CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), sph/ grid
 E=1:2.5:60 (24 points)
 Mon Mar  5 07:27:04 EST 2018

*** Found orbitals
1   1 Ene =   -1177.1254 Spin =Alpha Occup =   2.000000
2   2 Ene =    -180.9096 Spin =Alpha Occup =   2.000000
3   3 Ene =    -169.6288 Spin =Alpha Occup =   2.000000
4   4 Ene =    -169.6280 Spin =Alpha Occup =   2.000000
5   5 Ene =    -169.6280 Spin =Alpha Occup =   2.000000
6   6 Ene =     -37.8993 Spin =Alpha Occup =   2.000000
7   7 Ene =     -33.0914 Spin =Alpha Occup =   2.000000
8   8 Ene =     -33.0881 Spin =Alpha Occup =   2.000000
9   9 Ene =     -33.0881 Spin =Alpha Occup =   2.000000
10  10 Ene =     -24.2551 Spin =Alpha Occup =   2.000000
11  11 Ene =     -24.2539 Spin =Alpha Occup =   2.000000
12  12 Ene =     -24.2539 Spin =Alpha Occup =   2.000000
13  13 Ene =     -24.2506 Spin =Alpha Occup =   2.000000
14  14 Ene =     -24.2506 Spin =Alpha Occup =   2.000000
15  15 Ene =     -11.2780 Spin =Alpha Occup =   2.000000
16  16 Ene =      -7.2111 Spin =Alpha Occup =   2.000000
17  17 Ene =      -5.4461 Spin =Alpha Occup =   2.000000
18  18 Ene =      -5.4388 Spin =Alpha Occup =   2.000000
19  19 Ene =      -5.4388 Spin =Alpha Occup =   2.000000
20  20 Ene =      -2.3765 Spin =Alpha Occup =   2.000000
21  21 Ene =      -2.3724 Spin =Alpha Occup =   2.000000
22  22 Ene =      -2.3724 Spin =Alpha Occup =   2.000000
23  23 Ene =      -2.3631 Spin =Alpha Occup =   2.000000
24  24 Ene =      -2.3631 Spin =Alpha Occup =   2.000000
25  25 Ene =      -0.9966 Spin =Alpha Occup =   2.000000
26  26 Ene =      -0.7971 Spin =Alpha Occup =   2.000000
27  27 Ene =      -0.6101 Spin =Alpha Occup =   2.000000
28  28 Ene =      -0.6101 Spin =Alpha Occup =   2.000000
29  29 Ene =      -0.4641 Spin =Alpha Occup =   2.000000
30  30 Ene =      -0.3629 Spin =Alpha Occup =   2.000000
31  31 Ene =      -0.3629 Spin =Alpha Occup =   2.000000

*** Found atoms
Z = 53 ZS = 53 r =   0.0000000000   0.0000000000   1.9127440000
Z =  6 ZS =  6 r =   0.0000000000   0.0000000000  -0.2324950000
Z =  1 ZS =  1 r =  -0.5117920000   0.8864500000  -0.5600500000
Z =  1 ZS =  1 r =  -0.5117920000  -0.8864500000  -0.5600500000
Z =  1 ZS =  1 r =   1.0235850000   0.0000000000  -0.5600500000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Scan file(s) for various data types...</span>

<span class="c1"># For dir scan</span>
<span class="c1"># dataXS = ep.readMatEle(fileBase = dataPath, recordType = &#39;CrossSection&#39;)</span>
<span class="c1"># dataMatE = ep.readMatEle(fileBase = dataPath, recordType = &#39;DumpIdy&#39;)</span>

<span class="c1"># For single file</span>
<span class="n">dataXS</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">readMatEle</span><span class="p">(</span><span class="n">fileIn</span> <span class="o">=</span> <span class="n">dataFile</span><span class="p">,</span> <span class="n">recordType</span> <span class="o">=</span> <span class="s1">&#39;CrossSection&#39;</span><span class="p">)</span>
<span class="n">dataMatE</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">readMatEle</span><span class="p">(</span><span class="n">fileIn</span> <span class="o">=</span> <span class="n">dataFile</span><span class="p">,</span> <span class="n">recordType</span> <span class="o">=</span> <span class="s1">&#39;DumpIdy&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
*** ePSproc readMatEle(): scanning files for CrossSection segments.

*** Scanning file(s)
[&#39;/home/paul/ePS_results/CH3I/CH3I_1-60eV/CH3I_1-60eV_orb30_E.inp.out&#39;]

*** Reading ePS output file:  /home/paul/ePS_results/CH3I/CH3I_1-60eV/CH3I_1-60eV_orb30_E.inp.out
Expecting 24 energy points.
Expecting 4 symmetries.
Scanning CrossSection segments.
Expecting 5 CrossSection segments.
Found 5 CrossSection segments (sets of results).
Processed 5 sets of CrossSection file segments, (0 blank)
*** ePSproc readMatEle(): scanning files for DumpIdy segments.

*** Scanning file(s)
[&#39;/home/paul/ePS_results/CH3I/CH3I_1-60eV/CH3I_1-60eV_orb30_E.inp.out&#39;]

*** Reading ePS output file:  /home/paul/ePS_results/CH3I/CH3I_1-60eV/CH3I_1-60eV_orb30_E.inp.out
Expecting 24 energy points.
Expecting 4 symmetries.
Scanning CrossSection segments.
Expecting 96 DumpIdy segments.
Found 96 dumpIdy segments (sets of matrix elements).

Processing segments to Xarrays...
Processed 96 sets of DumpIdy file segments, (0 blank)
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Job-&amp;-molecule-info">
<h2>Job &amp; molecule info<a class="headerlink" href="#Job-&-molecule-info" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ep</span><span class="o">.</span><span class="n">jobSummary</span><span class="p">(</span><span class="n">jobInfo</span><span class="p">,</span> <span class="n">molInfo</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

*** Job summary data
 ePS CH3I, batch CH3I_1-60eV, orbital orb30_E
 CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), sph/ grid
 E=1:2.5:60 (24 points)
 Mon Mar  5 07:27:04 EST 2018

Electronic structure input: &#39;/media/hockettp/StoreM/ePolyScat_stuff/CH3I/electronic_structure/CH3I_ref_opt_SPK-AQZP_C3v.molden&#39;
Initial state occ:               [2 2 2 4 2 2 4 2 4 4 2 2 2 4 2 4 4 2 2 4 2 4]
Final state occ:                 [2 2 2 4 2 2 4 2 4 4 2 2 2 4 2 4 4 2 2 4 2 3]
IPot (input vertical IP, eV):            9.54

*** Additional orbital info (SymProd)
Ionizing orb:                    [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]
Ionizing orb sym:                [&#39;E&#39;]
Orb energy (eV):                 [-9.87501199]
Orb energy (H):                  [-0.3629]
Orb energy (cm^-1):              [-79647.34372628]
Threshold wavelength (nm):       125.5534652149492

*** Warning: some orbital convergences outside single-center expansion convergence tolerance (0.01):
[[1.0000000e+00 2.0136460e-02]
 [2.0000000e+00 5.8847706e-01]
 [3.0000000e+00 3.3933218e-01]
 [4.0000000e+00 9.3922660e-02]
 [5.0000000e+00 9.3922660e-02]
 [6.0000000e+00 7.6662327e-01]
 [7.0000000e+00 8.6152457e-01]
 [8.0000000e+00 7.6041242e-01]
 [9.0000000e+00 7.6041242e-01]
 [1.0000000e+01 6.8940314e-01]
 [1.1000000e+01 5.8978015e-01]
 [1.2000000e+01 5.8978015e-01]
 [1.3000000e+01 3.8623257e-01]
 [1.4000000e+01 3.8623257e-01]
 [1.6000000e+01 9.4364590e-01]
 [1.7000000e+01 9.6540337e-01]
 [1.8000000e+01 9.2145796e-01]
 [1.9000000e+01 9.2145796e-01]
 [2.0000000e+01 9.5859657e-01]
 [2.1000000e+01 9.3960899e-01]
 [2.2000000e+01 9.3960899e-01]
 [2.3000000e+01 9.1904483e-01]
 [2.4000000e+01 9.1904483e-01]]

*** Molecular structure

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_9_1.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_9_1.png" />
</div>
</div>
</div>
<div class="section" id="1-photon-ePS-Cross-Sections">
<h2>1-photon ePS Cross-Sections<a class="headerlink" href="#1-photon-ePS-Cross-Sections" title="Permalink to this headline">¶</a></h2>
<p>Plot 1-photon cross-sections and <span class="math notranslate nohighlight">\(beta_2\)</span> parameters (for an unaligned ensemble) from ePS calculations. These are taken directly from the ePS output file, <code class="docutils literal notranslate"><span class="pre">CrossSection</span></code> segments. See the <cite>ePS manual, ``GetCro`</cite> command, for further details &lt;<a class="reference external" href="https://www.chem.tamu.edu/rgroup/lucchese/ePolyScat.E3.manual/GetCro.html">https://www.chem.tamu.edu/rgroup/lucchese/ePolyScat.E3.manual/GetCro.html</a>&gt;`__.</p>
<div class="section" id="Cross-sections-by-symmetry-&amp;-type">
<h3>Cross-sections by symmetry &amp; type<a class="headerlink" href="#Cross-sections-by-symmetry-&-type" title="Permalink to this headline">¶</a></h3>
<p>Types correspond to:</p>
<ul class="simple">
<li><p>‘L’: length gauge results.</p></li>
<li><p>‘V’: velocity gauge results.</p></li>
<li><p>‘M’: mixed gauge results.</p></li>
</ul>
<p>Symmetries correspond to allowed ionizing transitions for the molecular point group (IRs typically corresponding to (x,y,z) polarization geometries), see the <a class="reference external" href="https://www.chem.tamu.edu/rgroup/lucchese/ePolyScat.E3.manual/SymmetryLabels.html">ePS manual for a list of symmetries</a>. Symmetry <code class="docutils literal notranslate"><span class="pre">All</span></code> corresponds to the sum over all allowed sets of symmetries.</p>
<p>Cross-section units are MBarn.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot cross sections using Xarray functionality</span>
<span class="c1"># Set here to plot per file - should add some logic to combine files.</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataXS</span><span class="p">:</span>
    <span class="n">daPlot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="s1">&#39;SIGMA&#39;</span><span class="p">)</span>
    <span class="n">daPlot</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;Type&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_12_0.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_12_0.png" />
</div>
</div>
</div>
<div class="section" id="\beta_{2}-by-symmetry-&amp;-type">
<h3><span class="math notranslate nohighlight">\(\beta_{2}\)</span> by symmetry &amp; type<a class="headerlink" href="#\beta_{2}-by-symmetry-&-type" title="Permalink to this headline">¶</a></h3>
<p>Types &amp; symmetries as per cross-sections. Normalized <span class="math notranslate nohighlight">\(\beta_{2}\)</span> paramters, dimensionless.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Repeat for betas</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataXS</span><span class="p">:</span>
    <span class="n">daPlot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="s1">&#39;BETA&#39;</span><span class="p">)</span>
    <span class="n">daPlot</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;Type&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_14_0.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_14_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Dipole-matrix-elements">
<h2>Dipole matrix elements<a class="headerlink" href="#Dipole-matrix-elements" title="Permalink to this headline">¶</a></h2>
<p>For 1-photon ionization. These are taken directly from ePS <code class="docutils literal notranslate"><span class="pre">DumpIdy</span></code> segments. See the <cite>ePS manual, ``DumpIdy`</cite> command, for further details &lt;<a class="reference external" href="https://www.chem.tamu.edu/rgroup/lucchese/ePolyScat.E3.manual/DumpIdy.html">https://www.chem.tamu.edu/rgroup/lucchese/ePolyScat.E3.manual/DumpIdy.html</a>&gt;`__.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set threshold for significance, only matrix elements with abs values &gt; thres % will be plotted</span>
<span class="n">thres</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot for each fie</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataMatE</span><span class="p">:</span>
    <span class="c1"># Plot with sensible defaults - all dims with lmPlot()</span>

    <span class="c1"># Plot only values &gt; theshold</span>
    <span class="n">daPlot</span><span class="p">,</span> <span class="n">daPlotpd</span><span class="p">,</span> <span class="n">legendList</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">thres</span> <span class="o">=</span> <span class="n">thres</span><span class="p">,</span> <span class="n">thresType</span> <span class="o">=</span> <span class="s1">&#39;pc&#39;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Plot phases, with unwrap</span>
    <span class="n">daPlot</span><span class="p">,</span> <span class="n">daPlotpd</span><span class="p">,</span> <span class="n">legendList</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">thres</span> <span class="o">=</span> <span class="n">thres</span><span class="p">,</span> <span class="n">thresType</span> <span class="o">=</span> <span class="s1">&#39;pc&#39;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">pType</span><span class="o">=</span><span class="s1">&#39;phaseUW&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/paul/anaconda3/envs/ePSproc-v1.2/lib/python3.7/site-packages/xarray/core/nputils.py:223: RuntimeWarning: All-NaN slice encountered
  result = getattr(npmodule, name)(values, axis=axis, **kwargs)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Plotting data CH3I_1-60eV_orb30_E.inp.out, pType=a, thres=1.419151168894083, with Seaborn
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/paul/anaconda3/envs/ePSproc-v1.2/lib/python3.7/site-packages/xarray/core/nputils.py:223: RuntimeWarning: All-NaN slice encountered
  result = getattr(npmodule, name)(values, axis=axis, **kwargs)
/home/paul/anaconda3/envs/ePSproc-v1.2/lib/python3.7/site-packages/numpy/lib/function_base.py:1520: RuntimeWarning: invalid value encountered in greater
  _nx.copyto(ddmod, pi, where=(ddmod == -pi) &amp; (dd &gt; 0))
/home/paul/anaconda3/envs/ePSproc-v1.2/lib/python3.7/site-packages/numpy/lib/function_base.py:1522: RuntimeWarning: invalid value encountered in less
  _nx.copyto(ph_correct, 0, where=abs(dd) &lt; discont)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Plotting data CH3I_1-60eV_orb30_E.inp.out, pType=phaseUW, thres=1.419151168894083, with Seaborn
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_17_4.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_17_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_17_5.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_17_5.png" />
</div>
</div>
</div>
<div class="section" id="MFPADs">
<h2>MFPADs<a class="headerlink" href="#MFPADs" title="Permalink to this headline">¶</a></h2>
<p>Calculated MF <span class="math notranslate nohighlight">\(\beta\)</span> parameters, using ePS dipole matrix elements. These are calculated by <code class="docutils literal notranslate"><span class="pre">ep.mfblm()</span></code>, as a function of energy and polarization geometry. See <cite>the ePSproc docs on ``ep.mfblm()`</cite> &lt;<a class="reference external" href="https://epsproc.readthedocs.io/en/latest/modules/epsproc.MFBLM.html">https://epsproc.readthedocs.io/en/latest/modules/epsproc.MFBLM.html</a>&gt;`__ for further details, and <a class="reference external" href="https://epsproc.readthedocs.io/en/latest/ePSproc_BLM_calc_demo_Sept2019_rst/ePSproc_BLM_calc_demo_Sept2019.html">this demo notebook</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set pol geoms - these correspond to (z,x,y) in molecular frame (relative to principle/symmetry axis)</span>
<span class="n">eAngs</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">setPolGeoms</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Drop threshold for MF calcs</span>
<span class="n">thres</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="c1"># Calculate for each fie &amp; pol geom</span>
<span class="c1"># TODO - file logic, and parallelize</span>
<span class="n">BLM</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataMatE</span><span class="p">:</span>
    <span class="n">BLM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ep</span><span class="o">.</span><span class="n">mfblmEuler</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">selDims</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Type&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">},</span> <span class="n">eAngs</span> <span class="o">=</span> <span class="n">eAngs</span><span class="p">,</span> <span class="n">thres</span> <span class="o">=</span> <span class="n">thres</span><span class="p">,</span>
                             <span class="n">SFflag</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Run for all Eke, selected gauge only</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Save BLM data - defaults to working dir and &#39;ep_timestamp&#39; file</span>
<span class="c1"># TODO - testing for array/multiple file case</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">BLM</span><span class="p">:</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="n">dataFile</span> <span class="o">+</span> <span class="s1">&#39;_BLM-L_&#39;</span> <span class="o">+</span> <span class="n">timeString</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">_%H-%M-%S&#39;</span><span class="p">)</span>
    <span class="n">ep</span><span class="o">.</span><span class="n">writeXarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileName</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Written to h5netcdf format&#39;, &#39;/home/paul/ePS_results/CH3I/CH3I_1-60eV/CH3I_1-60eV_orb30_E.inp.out_BLM-L_2020-02-10_09-08-11.nc&#39;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/paul/anaconda3/envs/ePSproc-v1.2/lib/python3.7/site-packages/h5netcdf/core.py:481: H5pyDeprecationWarning: other_ds.dims.create_scale(ds, name) is deprecated. Use ds.make_scale(name) instead.
  h5ds.dims.create_scale(h5ds, scale_name)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Normalize and plot results</span>
<span class="k">for</span> <span class="n">BLMplot</span> <span class="ow">in</span> <span class="n">BLM</span><span class="p">:</span>
    <span class="c1"># Plot unnormalized B00 only, real part</span>
    <span class="c1"># This is/should be in units of MBarn (TBC).</span>
<span class="c1">#     BLMplot.where(np.abs(BLMplot) &gt; thres, drop = True).real.squeeze().sel({&#39;l&#39;:0, &#39;m&#39;:0}).plot.line(x=&#39;Eke&#39;, col=&#39;Euler&#39;);</span>
    <span class="n">BLMplot</span><span class="o">.</span><span class="n">XS</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">);</span>

    <span class="c1"># Plot values normalised by B00 - now set in calculation function</span>
    <span class="c1"># Plot results with lmPlot(), ordering by Euler sets</span>
    <span class="c1"># Version with (semi-manual) Euler grouping</span>
    <span class="n">daPlot</span><span class="p">,</span> <span class="n">daPlotpd</span><span class="p">,</span> <span class="n">legendList</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">BLMplot</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;Euler&#39;</span><span class="p">:</span><span class="s1">&#39;Labels&#39;</span><span class="p">}),</span> <span class="n">SFflag</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">eulerGroup</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                   <span class="n">thresType</span> <span class="o">=</span> <span class="s1">&#39;pc&#39;</span><span class="p">,</span> <span class="n">thres</span> <span class="o">=</span> <span class="n">thres</span><span class="p">,</span>
                                                   <span class="n">plotDims</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Labels&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
                                                   <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Plotting data CH3I_1-60eV_orb30_E.inp.out, pType=a, thres=0.001017613059022104, with Seaborn
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_22_1.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_22_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_22_2.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_22_2.png" />
</div>
</div>
</div>
<div class="section" id="Error-&amp;-consistency-checks">
<h2>Error &amp; consistency checks<a class="headerlink" href="#Error-&-consistency-checks" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check SF values</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataMatE</span><span class="p">:</span>
    <span class="c1"># Plot values, single plot</span>
    <span class="n">data</span><span class="o">.</span><span class="n">SF</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">SF</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">SF</span><span class="o">.</span><span class="n">imag</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">)</span>

    <span class="c1"># Plot values, facet plot</span>
<span class="c1">#     data.SF.pipe(np.abs).plot.line(x=&#39;Eke&#39;, col=&#39;Sym&#39;)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_24_0.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_24_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compare calculated BLMs for L and V types (dafault above for L)</span>

<span class="c1"># Calculate for each fie &amp; pol geom, and compare.</span>
<span class="n">BLMv</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">BLMdiff</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataMatE</span><span class="p">):</span>
    <span class="n">BLMv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ep</span><span class="o">.</span><span class="n">mfblmEuler</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">selDims</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Type&#39;</span><span class="p">:</span><span class="s1">&#39;V&#39;</span><span class="p">},</span> <span class="n">eAngs</span> <span class="o">=</span> <span class="n">eAngs</span><span class="p">,</span> <span class="n">thres</span> <span class="o">=</span> <span class="n">thres</span><span class="p">,</span>
                             <span class="n">SFflag</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Run for all Eke, selected gauge only</span>

    <span class="n">BLMdiff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BLM</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">BLMv</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="n">BLMdiff</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;dXS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BLM</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">XS</span> <span class="o">-</span> <span class="n">BLMv</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">XS</span>  <span class="c1"># Set XS too, dropped in calc above</span>

    <span class="n">BLMdiff</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dataType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;matE&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Save BLM data - defaults to working dir and &#39;ep_timestamp&#39; file</span>
<span class="c1"># TODO - testing for array/multiple file case</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">BLMv</span><span class="p">:</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="n">dataFile</span> <span class="o">+</span> <span class="s1">&#39;_BLM-V_&#39;</span> <span class="o">+</span> <span class="n">timeString</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">_%H-%M-%S&#39;</span><span class="p">)</span>
    <span class="n">ep</span><span class="o">.</span><span class="n">writeXarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileName</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Written to h5netcdf format&#39;, &#39;/home/paul/ePS_results/CH3I/CH3I_1-60eV/CH3I_1-60eV_orb30_E.inp.out_BLM-V_2020-02-10_09-08-11.nc&#39;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/paul/anaconda3/envs/ePSproc-v1.2/lib/python3.7/site-packages/h5netcdf/core.py:481: H5pyDeprecationWarning: other_ds.dims.create_scale(ds, name) is deprecated. Use ds.make_scale(name) instead.
  h5ds.dims.create_scale(h5ds, scale_name)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Normalize and plot results</span>
<span class="k">for</span> <span class="n">BLMplot</span> <span class="ow">in</span> <span class="n">BLMv</span><span class="p">:</span>
    <span class="c1"># Plot unnormalized B00 only, real part</span>
    <span class="c1"># This is/should be in units of MBarn (TBC).</span>
<span class="c1">#     BLMplot.where(np.abs(BLMplot) &gt; thres, drop = True).real.squeeze().sel({&#39;l&#39;:0, &#39;m&#39;:0}).plot.line(x=&#39;Eke&#39;, col=&#39;Euler&#39;);</span>
    <span class="n">BLMplot</span><span class="o">.</span><span class="n">XS</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">);</span>

    <span class="c1"># Plot values normalised by B00 - now set in calculation function</span>
    <span class="c1"># Plot results with lmPlot(), ordering by Euler sets</span>
    <span class="c1"># Version with (semi-manual) Euler grouping</span>
    <span class="n">daPlot</span><span class="p">,</span> <span class="n">daPlotpd</span><span class="p">,</span> <span class="n">legendList</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">BLMplot</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;Euler&#39;</span><span class="p">:</span><span class="s1">&#39;Labels&#39;</span><span class="p">}),</span> <span class="n">SFflag</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">eulerGroup</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                   <span class="n">thresType</span> <span class="o">=</span> <span class="s1">&#39;pc&#39;</span><span class="p">,</span> <span class="n">thres</span> <span class="o">=</span> <span class="n">thres</span><span class="p">,</span>
                                                   <span class="n">plotDims</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Labels&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
                                                   <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Plotting data CH3I_1-60eV_orb30_E.inp.out, pType=a, thres=0.001, with Seaborn
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_27_1.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_27_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_27_2.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_27_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Difference between &#39;L&#39; and &#39;V&#39; results</span>
<span class="c1"># NOTE - this currently drops XS</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Differences, L vs. V gauge BLMs&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">BLMplot</span> <span class="ow">in</span> <span class="n">BLMdiff</span><span class="p">:</span>
    <span class="n">maxDiff</span> <span class="o">=</span> <span class="n">BLMplot</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Max difference in BLMs (L-V): </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">maxDiff</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">maxDiff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">thres</span><span class="p">:</span>
        <span class="c1"># Plot B00 only, real part</span>
<span class="c1">#         BLMplot.where(np.abs(BLMplot) &gt; thres, drop = True).real.squeeze().sel({&#39;l&#39;:0, &#39;m&#39;:0}).plot.line(x=&#39;Eke&#39;, col=&#39;Euler&#39;);</span>
        <span class="n">BLMplot</span><span class="o">.</span><span class="n">dXS</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">);</span>

        <span class="c1"># Plot values normalised by B00 - now set in calculation function</span>
        <span class="c1"># Plot results with lmPlot(), ordering by Euler sets</span>
        <span class="c1"># Version with (semi-manual) Euler grouping</span>
        <span class="n">daPlot</span><span class="p">,</span> <span class="n">daPlotpd</span><span class="p">,</span> <span class="n">legendList</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">BLMplot</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;Euler&#39;</span><span class="p">:</span><span class="s1">&#39;Labels&#39;</span><span class="p">}),</span> <span class="n">SFflag</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">eulerGroup</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                       <span class="n">thresType</span> <span class="o">=</span> <span class="s1">&#39;pc&#39;</span><span class="p">,</span> <span class="n">thres</span> <span class="o">=</span> <span class="n">thres</span><span class="p">,</span>
                                                       <span class="n">plotDims</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Labels&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
                                                       <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Differences, L vs. V gauge BLMs
Max difference in BLMs (L-V): 0 (0.332299981441156+2.9950448929007464e-17j)
Plotting data (No filename), pType=a, thres=0.00033229998144115603, with Seaborn
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_28_1.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_28_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_28_2.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_28_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check imaginary components - should be around machine tolerance.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Machine tolerance: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="k">for</span> <span class="n">BLMplot</span> <span class="ow">in</span> <span class="n">BLM</span><span class="p">:</span>
    <span class="n">maxImag</span> <span class="o">=</span> <span class="n">BLMplot</span><span class="o">.</span><span class="n">imag</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Max imaginary value: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">maxImag</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1">#     BLMplot.where(np.abs(BLMplot) &gt; thres, drop = True).imag.squeeze().plot.line(x=&#39;Eke&#39;, col=&#39;Euler&#39;);</span>

    <span class="n">BLMplot</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">matEleSelector</span><span class="p">(</span><span class="n">BLMplot</span><span class="p">,</span> <span class="n">thres</span><span class="o">=</span><span class="n">thres</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="s1">&#39;Eke&#39;</span><span class="p">)</span>
    <span class="n">BLMplot</span><span class="o">.</span><span class="n">imag</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Eke&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Machine tolerance:  2.220446049250313e-16
Max imaginary value: 0 0.5111423032385483
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_29_1.png" src="../_images/CH3I_1-60eV_CH3I_1-60eV_orb30_E_29_1.png" />
</div>
</div>
</div>
<div class="section" id="Version-info">
<h2>Version info<a class="headerlink" href="#Version-info" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Original-job-details">
<h3>Original job details<a class="headerlink" href="#Original-job-details" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">jobInfo</span><span class="p">[</span><span class="s1">&#39;ePolyScat&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Run: &#39;</span> <span class="o">+</span> <span class="n">jobInfo</span><span class="p">[</span><span class="s1">&#39;Starting&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;at&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ePolyScat Version E3
Run:  2018-03-13  03:21:35.541 (GMT -0400)
</pre></div></div>
</div>
</div>
<div class="section" id="ePSproc-details">
<h3>ePSproc details<a class="headerlink" href="#ePSproc-details" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">templateVersion</span> <span class="o">=</span> <span class="s1">&#39;0.0.6&#39;</span>
<span class="n">templateDate</span> <span class="o">=</span> <span class="s1">&#39;12/01/20&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> version_information
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">version_information</span> epsproc, xarray
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table><tr><th>Software</th><th>Version</th></tr><tr><td>Python</td><td>3.7.5 64bit [GCC 7.3.0]</td></tr><tr><td>IPython</td><td>7.9.0</td></tr><tr><td>OS</td><td>Linux 5.0.0 36 generic x86_64 with debian buster sid</td></tr><tr><td>epsproc</td><td>1.2.4</td></tr><tr><td>xarray</td><td>0.14.0</td></tr><tr><td colspan='2'>Tue Feb 11 13:31:20 2020 EST</td></tr></table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Run: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timeString</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">_%H-%M-%S&#39;</span><span class="p">)))</span>
<span class="n">host</span> <span class="o">=</span> <span class="o">!</span>hostname
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Host: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Run: 2020-02-10_09-08-11
Host: jake
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Cite-this-dataset">
<h2>Cite this dataset<a class="headerlink" href="#Cite-this-dataset" title="Permalink to this headline">¶</a></h2>
<p>Hockett, Paul (2018). <em>ePSproc: CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), 1 - 60 eV</em>. Dataset on Zenodo. DOI: 10.5281/zenodo.3660716. URL: <a class="reference external" href="https://phockett.github.io/ePSdata/CH3I_1-60eV/CH3I_1-60eV_orb30_E.html">https://phockett.github.io/ePSdata/CH3I_1-60eV/CH3I_1-60eV_orb30_E.html</a></p>
<p><em>Bibtex</em>:</p>
<div class="highlight-bibtex notranslate"><div class="highlight"><pre><span></span>@data{CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), 1 - 60 eV,
    title = {ePSproc: CH3I wavefn test run, orb 30 ioinzation (pi anti-bonding), 1 - 60 eV}
    author = {Hockett, Paul},
    doi = {10.5281/zenodo.3660716},
    publisher = {Zenodo},
    year = {2018},
    url = {https://phockett.github.io/ePSdata/CH3I_1-60eV/CH3I_1-60eV_orb30_E.html}
  }
</pre></div>
</div>
<p>See <a class="reference external" href="https://phockett.github.io/ePSdata/cite.html">citation notes on ePSdata</a> for further details.</p>
<p><a class="reference external" href="http://dx.doi.org/10.5281/zenodo.3660716"><img alt="DOI" src="https://zenodo.org/badge/doi/10.5281/zenodo.3660716.svg" /></a> <a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 (CC BY-NC-SA 4.0)" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../DABCO/DABCO_0.01-5.01eV_orb31_A1P.html" class="btn btn-neutral float-right" title="ePSproc: DABCO wavefn run, HOMO ionization (orb 31 A1P), 0.05 - 5.01eV high res" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="CH3I_1-60eV_orb29_A1.html" class="btn btn-neutral float-left" title="ePSproc: CH3I wavefn test run, orb 29 ioinzation (sigma bonding, A1), 1 - 60 eV" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Paul Hockett

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>